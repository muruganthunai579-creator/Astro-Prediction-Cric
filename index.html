<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Live Football + Astro Prediction</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <style>
    :root{
      --bg:#020617;
      --card:#0b1120;
      --accent:#22c55e;
      --accent-soft:rgba(34,197,94,0.2);
      --border:#1f2937;
      --text:#e5e7eb;
      --text-soft:#9ca3af;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:radial-gradient(circle at top,#1f2937 0,#020617 45%,#020617 100%);
      color:var(--text);
    }
    .wrap{max-width:960px;margin:0 auto;padding:14px 10px 32px;}
    h1{
      font-size:17px;
      text-transform:uppercase;
      letter-spacing:0.3em;
      color:#9ca3af;
      margin:4px 0 2px;
    }
    .tagline{
      font-size:11px;
      color:var(--text-soft);
      margin-bottom:12px;
    }
    .grid{
      display:grid;
      grid-template-columns:minmax(0,1.1fr) minmax(0,1fr);
      gap:10px;
    }
    @media(max-width:768px){
      .grid{grid-template-columns:minmax(0,1fr);}
    }
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:14px;
      padding:10px;
      box-shadow:0 18px 40px rgba(15,23,42,0.9);
    }
    .title{
      font-size:12px;
      text-transform:uppercase;
      letter-spacing:0.18em;
      color:var(--text-soft);
      margin-bottom:6px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .pill{
      font-size:10px;
      padding:2px 7px;
      border-radius:999px;
      border:1px solid var(--border);
      color:var(--text-soft);
    }
    label{
      display:block;
      font-size:10px;
      text-transform:uppercase;
      letter-spacing:0.13em;
      color:var(--text-soft);
      margin-bottom:3px;
    }
    input,select,textarea{
      width:100%;
      padding:7px 9px;
      border-radius:9px;
      border:1px solid var(--border);
      background:#020617;
      color:var(--text);
      font-size:12px;
      margin-bottom:7px;
      outline:none;
    }
    input:focus,select:focus,textarea:focus{
      border-color:var(--accent);
      box-shadow:0 0 0 1px rgba(34,197,94,0.4);
    }
    .row{display:flex;gap:6px;flex-wrap:wrap;}
    .row>div{flex:1;}
    button{
      border:none;
      border-radius:999px;
      padding:7px 12px;
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:0.14em;
      cursor:pointer;
      font-weight:600;
      display:inline-flex;
      align-items:center;
      gap:5px;
    }
    .btn-main{
      background:var(--accent);
      color:#022c22;
      box-shadow:0 10px 24px rgba(34,197,94,0.45);
      width:100%;
      justify-content:center;
      margin-top:6px;
    }
    .btn-ghost{
      background:#020617;
      border:1px solid var(--border);
      color:var(--text-soft);
      padding-inline:10px;
    }
    button:active{transform:scale(.98);}
    .match-list{
      max-height:380px;
      overflow-y:auto;
      margin-top:4px;
    }
    .match-card{
      border-radius:10px;
      border:1px solid var(--border);
      padding:7px 8px;
      margin-bottom:5px;
      background:#020617;
    }
    .match-row1{
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-size:12px;
    }
    .match-teams{
      font-weight:600;
    }
    .match-status{
      font-size:10px;
      padding:1px 6px;
      border-radius:999px;
      border:1px solid #4b5563;
      color:#e5e7eb;
    }
    .live{background:#dc2626;border-color:#fecaca;}
    .upcoming{background:#1e3a8a;border-color:#bfdbfe;}
    .league{
      font-size:10px;
      color:var(--text-soft);
      margin-top:4px;
    }
    .match-sub{
      font-size:10px;
      color:var(--text-soft);
      margin-top:3px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:4px;
    }
    .small-btn{
      border-radius:999px;
      padding:3px 7px;
      font-size:10px;
      border:1px solid var(--accent);
      background:var(--accent-soft);
      color:var(--accent);
    }
    .log{
      font-size:10px;
      color:var(--text-soft);
      margin-top:6px;
      white-space:pre-wrap;
    }
    .badge-row{
      display:flex;
      flex-wrap:wrap;
      gap:4px;
      margin-top:6px;
    }
    .badge{
      font-size:10px;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.4);
      color:var(--text-soft);
    }
    .badge-strong{
      border-color:rgba(34,197,94,0.7);
      background:var(--accent-soft);
      color:var(--accent);
    }
  </style>
</head>
<body>
<div class="wrap">
  <h1>ASTRO FOOTBALL PREDICTOR</h1>
  <div class="tagline">
    Live football matches ‚Üí click match ‚Üí teams auto-fill ‚Üí run your prediction.
  </div>

  <div class="grid">
    <!-- LEFT: LIVE MATCHES -->
    <section class="card">
      <div class="title">
        <span>Live / Today Matches</span>
        <span class="pill">Step 1 ¬∑ Choose Match</span>
      </div>

      <label for="apiKey">API-Football Key (free)</label>
      <input id="apiKey" placeholder="Paste your API key here" />

      <div class="row">
        <div>
          <label for="countryFilter">Country (optional)</label>
          <input id="countryFilter" placeholder="e.g. England, Spain, India" />
        </div>
        <div>
          <label for="leagueFilter">League (optional)</label>
          <input id="leagueFilter" placeholder="e.g. Premier League, La Liga" />
        </div>
      </div>

      <button class="btn-main" id="btnLoad">üîÑ Load Live / Today Matches</button>

      <div id="matchList" class="match-list">
        <!-- matches will render here -->
      </div>

      <div id="liveLog" class="log">
        Paste API key and click ‚ÄúLoad Live / Today Matches‚Äù.
      </div>
    </section>

    <!-- RIGHT: PREDICTION INPUT + RESULT -->
    <section class="card">
      <div class="title">
        <span>Match Prediction</span>
        <span class="pill">Step 2 ¬∑ Run Engine</span>
      </div>

      <div class="row">
        <div>
          <label>Team 1</label>
          <input id="team1" placeholder="Home team" />
        </div>
        <div>
          <label>Team 2</label>
          <input id="team2" placeholder="Away team" />
        </div>
      </div>

      <div class="row">
        <div>
          <label>Kickoff Date</label>
          <input id="matchDate" type="date" />
        </div>
        <div>
          <label>Kickoff Time</label>
          <input id="matchTime" type="time" />
        </div>
      </div>

      <div class="row">
        <div>
          <label>League</label>
          <input id="league" placeholder="League / Competition" />
        </div>
        <div>
          <label>Stadium / City</label>
          <input id="stadium" placeholder="Stadium / City" />
        </div>
      </div>

      <div class="row">
        <div>
          <label>Team 1 Jersey</label>
          <input id="jersey1" placeholder="Blue / Red / White‚Ä¶" />
        </div>
        <div>
          <label>Team 2 Jersey</label>
          <input id="jersey2" placeholder="Green / Yellow‚Ä¶" />
        </div>
      </div>

      <label for="notes">Extra notes</label>
      <textarea id="notes" placeholder="Derby, knockout, rotation, injuries‚Ä¶"></textarea>

      <button class="btn-main" id="btnPredict">‚ö° Run Simple Astro Prediction</button>

      <div class="badge-row" id="summaryBadges">
        <span class="badge">Engine idle</span>
      </div>
      <div class="log" id="predLog">
        Choose a match on the left or fill teams manually, then run prediction.
      </div>
    </section>
  </div>
</div>

<script>
// ------------ LIVE MATCH FETCH (API-FOOTBALL) ------------
// NOTE: You MUST sign up at api-football.com and use your own API key.
// This example uses v3 endpoint (RapidAPI style). Adjust host/header to your account.

async function loadMatches(){
  const apiKey = document.getElementById('apiKey').value.trim();
  const countryFilter = document.getElementById('countryFilter').value.trim().toLowerCase();
  const leagueFilter  = document.getElementById('leagueFilter').value.trim().toLowerCase();
  const logEl = document.getElementById('liveLog');
  const listEl = document.getElementById('matchList');

  if(!apiKey){
    alert("First paste your API-Football API key.");
    return;
  }

  logEl.textContent = "Loading matches from API-Football...";
  listEl.innerHTML = "";

  try{
    // Today date in YYYY-MM-DD (your local time)
    const today = new Date();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth()+1).padStart(2,'0');
    const dd = String(today.getDate()).padStart(2,'0');
    const dateStr = `${yyyy}-${mm}-${dd}`;

    // Example endpoint: fixtures by date
    const url = `https://v3.football.api-sports.io/fixtures?date=${dateStr}`;

    const res = await fetch(url,{
      method:"GET",
      headers:{
        "x-apisports-key": apiKey   // your API key here
      }
    });

    if(!res.ok){
      const txt = await res.text();
      logEl.textContent = "API error: "+res.status+" ‚Üí "+txt;
      return;
    }

    const data = await res.json();
    const fixtures = data.response || [];

    if(!fixtures.length){
      logEl.textContent = "No fixtures found for today.";
      return;
    }

    let count = 0;
    fixtures.forEach(fix=>{
      const leagueName = (fix.league && fix.league.name) || "";
      const country = (fix.league && fix.league.country) || "";
      const t1 = fix.teams && fix.teams.home ? fix.teams.home.name : "";
      const t2 = fix.teams && fix.teams.away ? fix.teams.away.name : "";
      const status = fix.fixture && fix.fixture.status ? fix.fixture.status.short : "";
      const kickoff = fix.fixture && fix.fixture.date ? new Date(fix.fixture.date) : null;
      const stadium = fix.fixture && fix.fixture.venue ? fix.fixture.venue.name : "";

      // filters
      if(countryFilter && !country.toLowerCase().includes(countryFilter)) return;
      if(leagueFilter && !leagueName.toLowerCase().includes(leagueFilter)) return;

      count++;

      const card = document.createElement("div");
      card.className = "match-card";

      const isLive = status === "1H" || status === "2H" || status === "ET" || status === "P" || status === "BT";
      const isNS   = status === "NS"; // not started

      const statusLabel = isLive
        ? "LIVE"
        : isNS ? "Upcoming" : status || "Status";

      const statusClass = isLive ? "match-status live" : "match-status upcoming";

      const timeText = kickoff
        ? kickoff.toLocaleString()
        : "-";

      card.innerHTML = `
        <div class="match-row1">
          <div class="match-teams">${t1} vs ${t2}</div>
          <div class="${statusClass}">${statusLabel}</div>
        </div>
        <div class="league">${leagueName} ¬∑ ${country}</div>
        <div class="match-sub">
          <span>${timeText}${stadium ? " ¬∑ "+stadium : ""}</span>
          <button class="small-btn">Use for prediction</button>
        </div>
      `;

      const btn = card.querySelector("button.small-btn");
      btn.addEventListener("click",()=>{
        fillPredictionFromMatch({
          team1:t1,
          team2:t2,
          league:leagueName,
          stadium:stadium,
          kickoff:kickoff
        });
      });

      listEl.appendChild(card);
    });

    if(count === 0){
      logEl.textContent = "No fixtures match your filters (country / league).";
    }else{
      logEl.textContent = `Loaded ${count} matches. Tap ‚ÄúUse for prediction‚Äù to auto-fill.`;
    }

  }catch(err){
    console.error(err);
    logEl.textContent = "Error loading matches: "+err.message;
  }
}

function fillPredictionFromMatch(match){
  document.getElementById("team1").value = match.team1 || "";
  document.getElementById("team2").value = match.team2 || "";
  document.getElementById("league").value = match.league || "";
  document.getElementById("stadium").value = match.stadium || "";

  if(match.kickoff instanceof Date && !isNaN(match.kickoff)){
    const d = match.kickoff;
    const yyyy = d.getFullYear();
    const mm = String(d.getMonth()+1).padStart(2,'0');
    const dd = String(d.getDate()).padStart(2,'0');
    const hh = String(d.getHours()).padStart(2,'0');
    const min = String(d.getMinutes()).padStart(2,'0');
    document.getElementById("matchDate").value = `${yyyy}-${mm}-${dd}`;
    document.getElementById("matchTime").value = `${hh}:${min}`;
  }

  const log = document.getElementById("predLog");
  log.textContent = "Match auto-filled from live list. Now adjust jersey colours / notes and run prediction.";
}

// ------------ SIMPLE ASTRO PREDICTION (placeholder) ------------

function runPrediction(){
  const team1 = document.getElementById("team1").value.trim() || "Team 1";
  const team2 = document.getElementById("team2").value.trim() || "Team 2";
  const jersey1 = document.getElementById("jersey1").value.trim().toLowerCase();
  const jersey2 = document.getElementById("jersey2").value.trim().toLowerCase();
  const date = document.getElementById("matchDate").value;
  const time = document.getElementById("matchTime").value;
  const league = document.getElementById("league").value.trim();
  const stadium = document.getElementById("stadium").value.trim();
  const notes = document.getElementById("notes").value.trim();

  const badges = [];
  const logLines = [];

  // Simple colour-based bias
  const warm = ["red","maroon","orange","yellow","gold"];
  const cool = ["blue","navy","black","green","white"];

  let score1 = 0, score2 = 0;

  if(jersey1 && warm.some(c=>jersey1.includes(c))) score1 += 2;
  if(jersey2 && warm.some(c=>jersey2.includes(c))) score2 += 2;
  if(jersey1 && cool.some(c=>jersey1.includes(c))) score2 += 1;
  if(jersey2 && cool.some(c=>jersey2.includes(c))) score1 += 1;

  // Day / time mini-effect
  if(date && time){
    const dt = new Date(date+"T"+time);
    const hour = dt.getHours();
    if(hour >= 21 || hour < 6){
      // night advantage to defensive / cool
      if(jersey2 && cool.some(c=>jersey2.includes(c))) score2 += 1;
      if(jersey1 && cool.some(c=>jersey1.includes(c))) score1 += 1;
      logLines.push("Night match ‚Üí cool / dark colours slightly boosted.");
    }else{
      if(jersey1 && warm.some(c=>jersey1.includes(c))) score1 += 1;
      if(jersey2 && warm.some(c=>jersey2.includes(c))) score2 += 1;
      logLines.push("Day match ‚Üí warm / bright colours slightly boosted.");
    }
  }

  const total = score1 + score2 || 1;
  let p1 = (score1/total)*100;
  let p2 = 100 - p1;

  // Soft clamp
  if(p1 > 70) p1 = 70;
  if(p1 < 30) p1 = 30;
  p2 = 100 - p1;

  let fav = "Balanced / 50-50";
  if(p1 > p2 + 1) fav = team1;
  else if(p2 > p1 + 1) fav = team2;

  badges.push(`Favoured side (colour-only dummy): ${fav}`);
  badges.push(`${team1} ~ ${p1.toFixed(1)}%`);
  badges.push(`${team2} ~ ${p2.toFixed(1)}%`);

  if(league) logLines.push("League: "+league);
  if(stadium) logLines.push("Stadium / City: "+stadium);
  if(notes) logLines.push("User notes: "+notes);

  logLines.push("");
  logLines.push("NOTE: This is only a SIMPLE placeholder.");
  logLines.push("Later we can plug your full Panchapakshi + Numerology + Jersey + GoalTime V2.0 engine here.");

  const badgeBox = document.getElementById("summaryBadges");
  badgeBox.innerHTML = "";
  badges.forEach(t=>{
    const span = document.createElement("span");
    span.className = "badge badge-strong";
    span.textContent = t;
    badgeBox.appendChild(span);
  });

  document.getElementById("predLog").textContent = logLines.join("\n");
}

// ------------ HOOK BUTTONS + INIT ------------

document.getElementById("btnLoad").addEventListener("click", e=>{
  e.preventDefault();
  loadMatches();
});

document.getElementById("btnPredict").addEventListener("click", e=>{
  e.preventDefault();
  runPrediction();
});

// set default date to today
(function(){
  const d = new Date();
  const yyyy = d.getFullYear();
  const mm = String(d.getMonth()+1).padStart(2,'0');
  const dd = String(d.getDate()).padStart(2,'0');
  document.getElementById("matchDate").value = `${yyyy}-${mm}-${dd}`;
})();
</script>
</body>
</html>
