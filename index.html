<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Astro Football ‚Äì Pure Panchapakshi</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <style>
    :root{
      --home-color:#0ea5e9;
      --away-color:#22c55e;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:#ffffff;
      color:#111827;
    }
    .wrap{
      max-width:960px;
      margin:0 auto;
      padding:12px;
    }
    h1{
      font-size:20px;
      text-transform:uppercase;
      letter-spacing:0.35em;
      color:#111827;
      text-align:center;
      margin:8px 0 4px;
    }
    .sub{
      text-align:center;
      font-size:11px;
      color:#6b7280;
      margin-bottom:10px;
    }
    h2{
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:0.26em;
      color:#6b7280;
      margin:12px 0 6px;
    }
    .card{
      background:#f9fafb;
      border:1px solid #e5e7eb;
      border-radius:14px;
      padding:10px;
      margin-bottom:12px;
      box-shadow:0 12px 30px rgba(15,23,42,0.06);
    }
    label{
      display:block;
      font-size:10px;
      text-transform:uppercase;
      letter-spacing:0.18em;
      color:#9ca3af;
      margin-bottom:3px;
    }
    input,select{
      width:100%;
      padding:7px 9px;
      border-radius:9px;
      border:1px solid #d1d5db;
      background:#ffffff;
      font-size:13px;
      color:#111827;
      margin-bottom:8px;
    }
    input:focus,select:focus{
      outline:none;
      border-color:#0ea5e9;
      box-shadow:0 0 0 1px #0ea5e9;
    }
    button{
      width:100%;
      padding:9px;
      border:none;
      border-radius:999px;
      font-size:11px;
      font-weight:600;
      text-transform:uppercase;
      letter-spacing:0.18em;
      cursor:pointer;
      color:#ffffff;
    }
    .btn-load{
      background:linear-gradient(90deg,#22c55e,#16a34a);
      box-shadow:0 8px 18px rgba(34,197,94,0.45);
    }
    .btn-run{
      background:linear-gradient(90deg,#0ea5e9,#6366f1);
      box-shadow:0 8px 18px rgba(59,130,246,0.45);
    }
    button:active{transform:scale(.97);}
    .row{display:flex;gap:8px;flex-wrap:wrap;}
    .row>div{flex:1;}
    .info{
      font-size:11px;
      color:#6b7280;
      margin-top:4px;
    }
    .info strong{color:#111827;}

    table{
      width:100%;
      border-collapse:collapse;
      font-size:11px;
    }
    th,td{
      border:1px solid #e5e7eb;
      padding:4px 6px;
      text-align:left;
      white-space:nowrap;
    }
    th{
      background:#e5f3ff;
      color:#374151;
      text-transform:uppercase;
      letter-spacing:0.08em;
      font-size:10px;
      position:sticky;
      top:0;
      z-index:2;
    }
    tbody tr:nth-child(even){background:#ffffff;}
    tbody tr:nth-child(odd){background:#f9fafb;}
    tbody tr:hover{
      background:#dbeafe;
      cursor:pointer;
    }
    .matches-wrap{
      max-height:320px;
      overflow-y:auto;
      margin-top:6px;
      border-radius:10px;
      border:1px solid #e5e7eb;
      background:#ffffff;
    }

    .tag{
      display:inline-block;
      padding:2px 8px;
      border-radius:999px;
      font-size:10px;
      text-transform:uppercase;
      letter-spacing:0.12em;
      margin-right:4px;
      font-weight:600;
    }
    .tag-live{background:#fee2e2;color:#b91c1c;}
    .tag-api{background:#e0f2fe;color:#0369a1;}
    .tag-win{background:#bbf7d0;color:#166534;}
    .tag-bal{background:#fee2a7;color:#92400e;}

    .good-text{color:#22c55e;font-weight:600;}
    .weak-text{color:#ef4444;font-weight:600;}
    .home-text{color:var(--home-color);font-weight:600;}
    .away-text{color:var(--away-color);font-weight:600;}

    .result-line{
      font-size:12px;
      margin-top:6px;
      line-height:1.5;
    }

    .bar-wrap{
      width:100%;
      height:16px;
      border-radius:999px;
      overflow:hidden;
      background:#e5e7eb;
      border:1px solid #d1d5db;
      margin:6px 0 4px 0;
      display:flex;
      position:relative;
    }
    .bar-fill{height:100%;}
    .bar-home{background:linear-gradient(90deg,var(--home-color),#38bdf8);}
    .bar-away{background:linear-gradient(90deg,var(--away-color),#22c55e);}
    .bar-label{
      position:absolute;
      left:50%;
      top:50%;
      transform:translate(-50%,-50%);
      font-size:10px;
      font-weight:600;
      white-space:nowrap;
      color:#ffffff;
      text-shadow:0 1px 2px rgba(0,0,0,0.55);
    }
    .bar-label span{color:#ffffff!important;}

    .bird-line{
      font-size:11px;
      margin-top:4px;
    }
    .lock{
      font-size:10px;
      color:#6b7280;
      text-transform:uppercase;
      letter-spacing:0.18em;
    }
  </style>
</head>
<body>
<div class="wrap">
  <h1>ASTRO FOOTBALL</h1>
  <div class="sub">Pure Panchapakshi ‚Ä¢ Football Only ‚Ä¢ Rule Lock üîí</div>

  <!-- STEP 1 -->
  <div class="card">
    <h2>Step 1 ¬∑ Load football matches (API-Football)</h2>

    <div class="row">
      <div>
        <label>API key (api-football.com)</label>
        <input id="apiKey" placeholder="Paste your API key" />
      </div>
      <div style="flex:0 0 140px;align-self:flex-end;">
        <button class="btn-load" onclick="loadMatches()">Load</button>
      </div>
    </div>

    <div class="info">
      <span class="tag tag-api">Info</span>
      Key is used only in your browser.  
      Shows <strong>today LIVE + upcoming</strong> fixtures. Finished matches are removed.  
      Red <span style="color:#ef4444;">‚óè LIVE</span> = match currently in play.  
      Click a row to send the match into Step 2.
    </div>

    <div id="matchesContainer" class="matches-wrap">
      <table>
        <thead>
          <tr>
            <th>Kickoff</th>
            <th>Home</th>
            <th>Away</th>
            <th>League</th>
            <th>City / Country</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="matchesBody"></tbody>
      </table>
    </div>
  </div>

  <!-- STEP 2 -->
  <div class="card">
    <h2>Step 2 ¬∑ Match input & Panchapakshi prediction</h2>

    <div class="row">
      <div>
        <label>Home team</label>
        <input id="homeTeam" placeholder="Home team name" />
      </div>
      <div>
        <label>Away team</label>
        <input id="awayTeam" placeholder="Away team name" />
      </div>
    </div>

    <div class="row">
      <div>
        <label>Kickoff date (venue)</label>
        <input id="kickoffDate" type="date" />
      </div>
      <div>
        <label>Kickoff time (venue)</label>
        <input id="kickoffTime" type="time" />
      </div>
      <div>
        <label>Venue timezone (from API)</label>
        <input id="venueTz" placeholder="Ex: Europe/London" />
      </div>
    </div>

    <div class="row">
      <div>
        <label>League / competition</label>
        <input id="leagueName" placeholder="Ex: Premier League" />
      </div>
      <div>
        <label>City / country</label>
        <input id="cityCountry" placeholder="Ex: Liverpool, England" />
      </div>
    </div>

    <div class="row">
      <div>
        <label>Paksha (auto from date)</label>
        <select id="paksha">
          <option value="shukla">Shukla</option>
          <option value="krishna">Krishna</option>
        </select>
      </div>
      <div>
        <label>Bird lock</label>
        <div class="lock">Numerology ‚Üí 27 nakshatra ‚Üí Bird</div>
      </div>
    </div>

    <div id="birdsInfo" class="bird-line"></div>

    <div class="row" style="margin-top:6px;">
      <div>
        <label>&nbsp;</label>
        <button class="btn-run" onclick="runPanchapakshi()">Run Panchapakshi Prediction</button>
      </div>
    </div>

    <div id="dayInfo" class="info"></div>
    <div id="predictionSummary" class="result-line"></div>
  </div>
</div>

<script>
/* -----------------------
   CONSTANTS / TABLES
   ----------------------- */

const BIRDS = ['Vulture','Owl','Crow','Cock','Peacock'];

const DAY_PLANETS = ['Sun','Moon','Mars','Mercury','Jupiter','Venus','Saturn'];

const BIRD_PLANETS = {
  shukla:{
    Vulture:['Jupiter','Saturn'],
    Owl:['Sun','Venus'],
    Crow:['Moon'],
    Cock:['Mars'],
    Peacock:['Mercury']
  },
  krishna:{
    Vulture:['Mars'],
    Owl:['Moon'],
    Crow:['Sun'],
    Cock:['Jupiter','Saturn'],
    Peacock:['Mercury','Venus']
  }
};

function deriveRulingBirds(paksha){
  const map=BIRD_PLANETS[paksha];
  const out=[];
  for(let d=0;d<7;d++){
    const planet=DAY_PLANETS[d];
    let chosen='Vulture';
    for(const b of BIRDS){
      const list=map[b]||[];
      if(list.includes(planet)){chosen=b;break;}
    }
    out.push(chosen);
  }
  return out;
}
const RULING_BIRDS={
  shukla:deriveRulingBirds('shukla'),
  krishna:deriveRulingBirds('krishna')
};

/* Panchapakshi activity scores (locked rule) */
const ACTIVITY_STRENGTH={
  Rule:{score:100},
  Eat:{score:80},
  Walk:{score:50},
  Sleep:{score:30},
  Die:{score:0}
};
const APAHARA_DURATIONS={Rule:48,Eat:30,Walk:36,Sleep:18,Die:12};
const ACTIVITY_CYCLES={
  shukla_day:['Eat','Walk','Rule','Sleep','Die'],
  shukla_night:['Eat','Rule','Die','Walk','Sleep'],
  krishna_day:['Eat','Die','Sleep','Rule','Walk'],
  krishna_night:['Eat','Sleep','Walk','Die','Rule']
};

/* 27 nakshatra ‚Üí bird table */
const PLAYER_NAK_BIRDS=[
  'Peacock','Peacock','Peacock','Peacock','Peacock',
  'Cock','Cock','Cock','Cock','Cock','Cock',
  'Crow','Crow','Crow','Crow','Crow',
  'Owl','Owl','Owl','Owl','Owl',
  'Vulture','Vulture','Vulture','Vulture','Vulture','Vulture'
];

/* Chaldean numerology map */
const NUM_MAP={
  1:"A I J Q Y",
  2:"B K R",
  3:"C G L S",
  4:"D M T",
  5:"E H N X",
  6:"U V W",
  7:"O Z",
  8:"F P"
};
const LETTER_TO_NUM={};
for(const [val,letters] of Object.entries(NUM_MAP)){
  letters.split(" ").forEach(ch=>{
    LETTER_TO_NUM[ch]=Number(val);
  });
}

/* -----------------------
   HELPER FUNCTIONS
   ----------------------- */

function timeToMins(t){
  if(!t)return 0;
  const [h,m]=t.split(':').map(Number);
  return h*60+m;
}
function minsToTime(m){
  let x=m;
  while(x<0)x+=1440;
  x=x%1440;
  const h=Math.floor(x/60);
  const mm=x%60;
  return String(h).padStart(2,'0')+":"+String(mm).padStart(2,'0');
}

/* moon age ‚Üí paksha */
function computeMoonAge(date){
  const year=date.getUTCFullYear();
  const month=date.getUTCMonth()+1;
  const day=date.getUTCDate();
  let yy=year-Math.floor((12-month)/10);
  let mm=month+9;
  if(mm>=12)mm-=12;
  const k1=Math.floor(365.25*(yy+4712));
  const k2=Math.floor(30.6*mm+0.5);
  const k3=Math.floor(Math.floor((yy/100)+49)*0.75)-38;
  const jd=k1+k2+day+59-k3;
  const ip=(jd-2451550.1)/29.530588853;
  const frac=ip-Math.floor(ip);
  return frac*29.530588853;
}
function autoPakshaFromDateStr(dateStr){
  if(!dateStr)return'shukla';
  const d=new Date(dateStr+"T12:00:00Z");
  const age=computeMoonAge(d);
  return age<14.765?'shukla':'krishna';
}

/* numerology ‚Üí nakshatra ‚Üí bird */

function numerologyValue(name){
  if(!name)return 0;
  let sum=0;
  for(const ch of name.toUpperCase()){
    if(LETTER_TO_NUM[ch]) sum+=LETTER_TO_NUM[ch];
  }
  return sum;
}
function nakshatraFromNumber(num){
  if(num<=0)return 1;
  return ((num-1)%27)+1; // 1..27
}
function birdFromNakshatra(n){
  return PLAYER_NAK_BIRDS[(n-1)%27];
}
function birdFromTeamName(name){
  const val=numerologyValue(name);
  const nak=nakshatraFromNumber(val);
  return birdFromNakshatra(nak);
}

/* yabha / apahara integration */

function getMainYamaContext(bird,timeMins,dayIdx,pakshaType){
  const dayStart=360, nightStart=1080, yamaDuration=144;
  let isNight=false,minsSinceStart=0,cycleStartMins=dayStart;
  let t=timeMins;
  if(t<dayStart)t+=1440;

  if(t>=dayStart && t<nightStart){
    isNight=false;
    minsSinceStart=t-dayStart;
    cycleStartMins=dayStart;
  }else{
    isNight=true;
    if(t>=nightStart){
      minsSinceStart=t-nightStart;
      cycleStartMins=nightStart;
    }else{
      minsSinceStart=(t+1440)-nightStart;
      cycleStartMins=nightStart;
    }
  }
  const yamaIndex=Math.floor(minsSinceStart/yamaDuration);
  const clamped=Math.min(yamaIndex,4);
  const key=pakshaType+'_'+(isNight?'night':'day');
  const cycle=ACTIVITY_CYCLES[key];
  const ruling=RULING_BIRDS[pakshaType][dayIdx];

  const bi=BIRDS.indexOf(bird);
  const ri=BIRDS.indexOf(ruling);
  const dist=(bi-ri+5)%5;
  const actIdx=(clamped+dist)%5;
  const mainActivity=cycle[actIdx];
  const yamaStartTime=cycleStartMins+(clamped*yamaDuration);
  return {mainActivity,yamaStartTime,activityCycle:cycle};
}

function integrateBirdScore(bird,startMins,endMins,dayIdx,pakshaType){
  let totalScore=0,totalDur=0;
  let cur=startMins;

  while(cur<endMins){
    const {mainActivity,yamaStartTime,activityCycle}=getMainYamaContext(bird,cur%1440,dayIdx,pakshaType);
    const mainIdx=activityCycle.indexOf(mainActivity);

    let subStart=yamaStartTime;
    const subs=[];
    for(let i=0;i<5;i++){
      const act=activityCycle[(mainIdx+i)%5];
      const dur=APAHARA_DURATIONS[act];
      subs.push({act,start:subStart,end:subStart+dur});
      subStart+=dur;
    }

    for(const s of subs){
      const effStart=Math.max(cur,s.start);
      const effEnd=Math.min(endMins,s.end);
      if(effEnd>effStart){
        const d=effEnd-effStart;
        const score=ACTIVITY_STRENGTH[s.act].score;
        totalScore+=score*d;
        totalDur+=d;
        cur=effEnd;
      }
    }
    const yamaEnd=yamaStartTime+144;
    if(cur<yamaEnd)cur=yamaEnd;
  }
  return {totalScore,totalDur};
}

/* ----------
   API-FOOTBALL
   ---------- */

async function loadMatches(){
  const key=document.getElementById('apiKey').value.trim();
  if(!key){alert("Enter your API key from api-football.com");return;}

  const headers={'x-apisports-key':key};
  const today=new Date();
  const y=today.getFullYear();
  const m=String(today.getMonth()+1).padStart(2,'0');
  const d=String(today.getDate()).padStart(2,'0');
  const dateStr=`${y}-${m}-${d}`;

  const upcomingUrl=`https://v3.football.api-sports.io/fixtures?date=${dateStr}`;
  const liveUrl=`https://v3.football.api-sports.io/fixtures?live=all`;

  try{
    const [upRes,liveRes]=await Promise.all([
      fetch(upcomingUrl,{headers}),
      fetch(liveUrl,{headers})
    ]);
    const upData=(await upRes.json()).response||[];
    const liveData=(await liveRes.json()).response||[];

    const map=new Map();
    [...liveData,...upData].forEach(f=>map.set(f.fixture.id,f));
    const allFixtures=Array.from(map.values());
    renderMatches(allFixtures);
  }catch(e){
    console.error(e);
    alert("API error ‚Äì check key / quota in console.");
  }
}

function renderMatches(allFixtures){
  const tbody=document.getElementById('matchesBody');
  tbody.innerHTML='';
  const now=Math.floor(Date.now()/1000);
  const liveStatuses=['1H','2H','ET','BT','P','INT'];

  const fixtures=allFixtures
    .filter(f=>{
      const s=f.fixture.status.short;
      const ts=f.fixture.timestamp;
      if(liveStatuses.includes(s))return true;
      if((s==='NS'||s==='TBD') && ts>=now)return true;
      return false;
    })
    .sort((a,b)=>a.fixture.timestamp-b.fixture.timestamp);

  fixtures.forEach(f=>{
    const tr=document.createElement('tr');
    const dt=new Date(f.fixture.date);
    const dateStr=dt.toISOString().slice(0,10);
    const timeStr=dt.toTimeString().slice(0,5);

    const s=f.fixture.status;
    const shortStatus=s.short;
    const liveStatuses=['1H','2H','ET','BT','P','INT'];
    const isLive=liveStatuses.includes(shortStatus);
    const liveDot=isLive?' <span style="color:#ef4444;">‚óè LIVE</span>':'';

    const city=f.fixture.venue.city||'';
    const country=f.fixture.venue.country||'';

    tr.innerHTML=
      `<td>${dateStr} ${timeStr}</td>
       <td>${f.teams.home.name}${liveDot}</td>
       <td>${f.teams.away.name}</td>
       <td>${f.league.name||''}</td>
       <td>${city && country?`${city}, ${country}`:city||country||''}</td>
       <td>${isLive?'LIVE':shortStatus}</td>`;

    tr.addEventListener('click',()=>{
      fillStep2FromFixture(f);
      window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'});
    });
    tbody.appendChild(tr);
  });
}

function fillStep2FromFixture(fix){
  const dt=new Date(fix.fixture.date);
  const dateStr=dt.toISOString().slice(0,10);
  const timeStr=dt.toTimeString().slice(0,5);

  document.getElementById('homeTeam').value=fix.teams.home.name||'';
  document.getElementById('awayTeam').value=fix.teams.away.name||'';
  document.getElementById('leagueName').value=fix.league.name||'';

  const city=fix.fixture.venue.city||'';
  const country=fix.fixture.venue.country||'';
  document.getElementById('cityCountry').value=
    city && country?`${city}, ${country}`:city||country||'';

  document.getElementById('kickoffDate').value=dateStr;
  document.getElementById('kickoffTime').value=timeStr;
  document.getElementById('venueTz').value=fix.fixture.timezone||'';

  const paksha=autoPakshaFromDateStr(dateStr);
  document.getElementById('paksha').value=paksha;
  updateDayInfo();
  updateBirdsDisplay();
}

/* -----------
   UI HELPERS
   ----------- */

function updateDayInfo(){
  const dateStr=document.getElementById('kickoffDate').value;
  const paksha=document.getElementById('paksha').value;
  const out=document.getElementById('dayInfo');
  if(!dateStr){out.textContent='';return;}
  const d=new Date(dateStr+"T12:00:00Z");
  const dayIdx=d.getUTCDay();
  const ruling=RULING_BIRDS[paksha][dayIdx];
  out.innerHTML=
    `<span class="tag">Day Bird</span> `+
    `Ruling bird for match day: <span class="good-text">${ruling}</span> `+
    `(Paksha: ${paksha.charAt(0).toUpperCase()+paksha.slice(1)})`;
}

function updateBirdsDisplay(){
  const home=document.getElementById('homeTeam').value.trim()||'Home';
  const away=document.getElementById('awayTeam').value.trim()||'Away';
  const homeBird=birdFromTeamName(home);
  const awayBird=birdFromTeamName(away);

  const div=document.getElementById('birdsInfo');
  div.innerHTML=
    `<strong>Auto team birds (locked):</strong> `+
    `<span class="home-text">${home}</span> ‚Üí ${homeBird} &nbsp;‚Ä¢&nbsp; `+
    `<span class="away-text">${away}</span> ‚Üí ${awayBird}`;
}

/* score suggestion from percentages */
function suggestScore(pHome,pAway){
  const diff=Math.abs(pHome-pAway);
  const favourite=pHome>pAway?'home':pAway>pHome?'away':'draw';

  if(diff<=4){
    // tight = draw prediction
    const goals=(pHome+pAway)/100*2.2; // around 2 goals
    const g=Math.round(goals);
    const g1=Math.max(1,Math.min(2,g));
    return {home:g1,away:g1};
  }

  const favPct=Math.max(pHome,pAway);
  const underPct=Math.min(pHome,pAway);

  let favGoals=1.2 + (favPct-50)/15;   // 1.2 to around 4-5
  favGoals=Math.max(1,Math.min(5,Math.round(favGoals)));

  let margin=1;
  if(diff>15)margin=2;
  if(diff>30)margin=3;

  let underGoals=favGoals-margin;
  if(underGoals<0)underGoals=0;

  if(favourite==='home'){
    return {home:favGoals,away:underGoals};
  }else if(favourite==='away'){
    return {home:underGoals,away:favGoals};
  }else{
    return {home:1,away:1};
  }
}

/* -----------
   PREDICTION
   ----------- */

function makeBar(pHome,pAway,homeName,awayName){
  return `
    <div class="bar-wrap">
      <div class="bar-fill bar-home" style="width:${pHome}%;"></div>
      <div class="bar-fill bar-away" style="width:${pAway}%;"></div>
      <div class="bar-label">
        <span class="home-text">${homeName} ${pHome.toFixed(1)}%</span>
        &nbsp;‚Ä¢&nbsp;
        <span class="away-text">${awayName} ${pAway.toFixed(1)}%</span>
      </div>
    </div>`;
}

function runPanchapakshi(){
  const home=document.getElementById('homeTeam').value.trim()||'Home';
  const away=document.getElementById('awayTeam').value.trim()||'Away';
  const dateStr=document.getElementById('kickoffDate').value;
  const timeStr=document.getElementById('kickoffTime').value;
  const paksha=document.getElementById('paksha').value;

  if(!dateStr || !timeStr){
    alert("Set kickoff date & time.");
    return;
  }

  const homeBird=birdFromTeamName(home);
  const awayBird=birdFromTeamName(away);
  updateBirdsDisplay();
  updateDayInfo();

  const matchDate=new Date(dateStr+"T12:00:00Z");
  const dayIdx=matchDate.getUTCDay();

  const startMins=timeToMins(timeStr);
  const endMins=startMins+120; // 120 mins window

  const hScore=integrateBirdScore(homeBird,startMins,endMins,dayIdx,paksha);
  const aScore=integrateBirdScore(awayBird,startMins,endMins,dayIdx,paksha);

  const total=hScore.totalScore+aScore.totalScore || 1;
  let pHome=(hScore.totalScore/total)*100;
  let pAway=100-pHome;

  const clamp=p=>{
    if(p>75)return 75;
    if(p<25)return 25;
    return p;
  };
  pHome=clamp(pHome);
  pAway=100-pHome;

  let winner='Balanced / 50-50';
  if(pHome>pAway+1)winner=home;
  else if(pAway>pHome+1)winner=away;

  const diff=Math.abs(pHome-pAway);
  const drawYes = diff<=4; // very close ‚Üí draw yes

  const barHtml=makeBar(pHome,pAway,home,away);
  const score=suggestScore(pHome,pAway);

  let winLine='';
  if(winner===home){
    winLine=`Overall Winner: <span class="home-text">${home}</span>`;
  }else if(winner===away){
    winLine=`Overall Winner: <span class="away-text">${away}</span>`;
  }else{
    winLine=`<span class="tag tag-bal">Balanced ‚Äì can go either side</span>`;
  }

  const drawLine=
    `Draw (Yes / No): <strong>${drawYes?'YES ‚Äì energy equal':'NO ‚Äì one side clear edge'}</strong>`;

  const scoreLine=
    `Score hint (from bird activity): `+
    `<strong>${home} ${score.home} ‚Äì ${score.away} ${away}</strong>`;

  document.getElementById('predictionSummary').innerHTML=
    `<span class="tag tag-win">Panchapakshi Result</span><br>`+
    winLine+`<br>`+
    barHtml+`<br>`+
    drawLine+`<br>`+
    scoreLine+`<br>`+
    `<span class="info"><strong>Engine:</strong> Pure Panchapakshi only (Rule 100 ¬∑ Eat 80 ¬∑ Walk 50 ¬∑ Sleep 30 ¬∑ Die 0). Team birds are locked from team-name numerology ‚Üí 27 nakshatra ‚Üí bird.</span>`;
}

/* INIT */
(function init(){
  const today=new Date();
  const y=today.getFullYear();
  const m=String(today.getMonth()+1).padStart(2,'0');
  const d=String(today.getDate()).padStart(2,'0');
  const dateStr=`${y}-${m}-${d}`;
  document.getElementById('kickoffDate').value=dateStr;
  document.getElementById('kickoffTime').value='20:00';
  const paksha=autoPakshaFromDateStr(dateStr);
  document.getElementById('paksha').value=paksha;
  updateDayInfo();
  updateBirdsDisplay();

  document.getElementById('homeTeam').addEventListener('input',updateBirdsDisplay);
  document.getElementById('awayTeam').addEventListener('input',updateBirdsDisplay);
  document.getElementById('kickoffDate').addEventListener('change',()=>{
    const p=autoPakshaFromDateStr(document.getElementById('kickoffDate').value);
    document.getElementById('paksha').value=p;
    updateDayInfo();
  });
})();
</script>
</body>
</html>
