<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Astro Football ‚Ä¢ Pure Panchapakshi</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root{
      --home-main:#0ea5e9;
      --away-main:#22c55e;
    }

    *{box-sizing:border-box;}

    body{
      margin:0;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:#ffffff;
      color:#111827;
    }
    .wrap{
      max-width:920px;
      margin:0 auto;
      padding:12px 12px 40px;
    }
    h1{
      font-size:18px;
      letter-spacing:0.25em;
      text-transform:uppercase;
      color:#4b5563;
      margin:8px 0 2px;
      text-align:center;
    }
    h2{
      font-size:10px;
      letter-spacing:0.18em;
      text-transform:uppercase;
      color:#6b7280;
      text-align:center;
      margin:0 0 14px;
    }
    .card{
      background:#f3f4f6;
      border-radius:16px;
      border:1px solid #e5e7eb;
      padding:12px;
      margin-bottom:12px;
      box-shadow:0 10px 25px rgba(15,23,42,0.08);
    }
    .title-sm{
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:0.22em;
      color:#6b7280;
      margin-bottom:8px;
    }
    label{
      display:block;
      font-size:10px;
      text-transform:uppercase;
      letter-spacing:0.18em;
      color:#9ca3af;
      margin-bottom:3px;
    }
    input,select{
      width:100%;
      padding:8px 10px;
      border-radius:10px;
      border:1px solid #d1d5db;
      background:#ffffff;
      font-size:13px;
      color:#111827;
      margin-bottom:8px;
    }
    input:focus,select:focus{
      outline:none;
      border-color:#0ea5e9;
      box-shadow:0 0 0 1px #0ea5e9;
    }
    button{
      width:100%;
      padding:9px;
      border:none;
      border-radius:999px;
      text-transform:uppercase;
      letter-spacing:0.18em;
      font-size:11px;
      font-weight:600;
      color:#ffffff;
      cursor:pointer;
    }
    button:active{transform:scale(.97);}

    .btn-primary{
      background:linear-gradient(90deg,#2563eb,#22c55e);
      box-shadow:0 8px 18px rgba(37,99,235,0.4);
    }
    .btn-secondary{
      background:linear-gradient(90deg,#4b5563,#111827);
      box-shadow:0 8px 18px rgba(15,23,42,0.4);
    }

    .row{display:flex;flex-wrap:wrap;gap:8px;}
    .row>div{flex:1 1 120px;}

    .tiny{
      font-size:11px;
      color:#6b7280;
      line-height:1.6;
      margin-top:4px;
    }

    table{
      width:100%;
      border-collapse:collapse;
      font-size:11px;
    }
    th,td{
      border:1px solid #e5e7eb;
      padding:4px 6px;
      text-align:left;
    }
    th{
      background:#e5f3ff;
      text-transform:uppercase;
      letter-spacing:0.08em;
      font-size:10px;
      color:#374151;
      position:sticky;
      top:0;
      z-index:1;
    }
    tr:nth-child(even){background:#ffffff;}
    tr:nth-child(odd){background:#f9fafb;}
    tr.clickable{cursor:pointer;}
    tr.clickable:hover{background:#e0f2fe;}

    .matches-wrap{
      max-height:260px;
      overflow-y:auto;
      border-radius:10px;
      border:1px solid #e5e7eb;
      background:#ffffff;
      margin-top:6px;
    }

    .tag{
      display:inline-block;
      padding:2px 8px;
      border-radius:999px;
      text-transform:uppercase;
      letter-spacing:0.12em;
      font-size:10px;
      font-weight:600;
      margin-right:4px;
      margin-bottom:2px;
    }
    .tag-info{background:#dbeafe;color:#1d4ed8;}
    .tag-win{background:#bbf7d0;color:#166534;}
    .tag-draw{background:#fee2a7;color:#92400e;}
    .tag-score{background:#e0f2fe;color:#075985;}

    .good-text{color:#16a34a;font-weight:600;}
    .bad-text{color:#ef4444;font-weight:600;}
    .mid-text{color:#4b5563;font-weight:600;}

    .home-text{color:var(--home-main);font-weight:600;}
    .away-text{color:var(--away-main);font-weight:600;}

    .bar-wrap{
      width:100%;
      height:16px;
      border-radius:999px;
      overflow:hidden;
      background:#e5e7eb;
      border:1px solid #d1d5db;
      margin:6px 0;
      position:relative;
      display:flex;
    }
    .bar-home{
      height:100%;
      background:linear-gradient(90deg,var(--home-main),#38bdf8);
    }
    .bar-away{
      height:100%;
      background:linear-gradient(90deg,var(--away-main),#22c55e);
    }
    .bar-label{
      position:absolute;
      left:50%;
      top:50%;
      transform:translate(-50%,-50%);
      font-size:10px;
      font-weight:600;
      color:#ffffff;
      text-shadow:0 1px 2px rgba(0,0,0,0.6);
      white-space:nowrap;
    }

    .live-dot{
      color:#ef4444;
      font-size:10px;
      font-weight:900;
      margin-right:2px;
    }

    .error-text{
      color:#b91c1c;
      font-size:11px;
      margin-top:4px;
    }
  </style>
</head>
<body>
<div class="wrap">
  <h1>ASTRO FOOTBALL</h1>
  <h2>Pure Panchapakshi ‚Ä¢ Football Only ‚Ä¢ Rule Lock üîí</h2>

  <!-- STEP 1 -->
  <div class="card">
    <div class="title-sm">Step 1 ¬∑ Load Football Matches (API-Football)</div>

    <div class="row">
      <div>
        <label>API key (api-football.com)</label>
        <input id="apiKey" placeholder="Paste your API key" />
      </div>
      <div>
        <label>Matches</label>
        <select id="matchFilter">
          <option value="today">Today ¬∑ Live & Upcoming</option>
        </select>
      </div>
      <div style="flex:0 0 120px;align-self:flex-end;">
        <button class="btn-primary" id="btnLoad">Load</button>
      </div>
    </div>

    <div class="tiny">
      Key is used only in your browser. Shows today <b>LIVE</b> (red dot) + upcoming fixtures.  
      Finished matches are removed. Click a row below to send the match into Step 2.
    </div>

    <div id="apiError" class="error-text" style="display:none;"></div>

    <div class="matches-wrap" id="matchesWrap" style="display:none;">
      <table id="matchesTable">
        <thead>
          <tr>
            <th>Kickoff</th>
            <th>Home</th>
            <th>Away</th>
            <th>League</th>
            <th>City / Country</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- STEP 2 -->
  <div class="card">
    <div class="title-sm">Step 2 ¬∑ Match Input (From API or Manual)</div>

    <div class="row">
      <div>
        <label>Home team</label>
        <input id="homeTeam" placeholder="Home team name" />
      </div>
      <div>
        <label>Away team</label>
        <input id="awayTeam" placeholder="Away team name" />
      </div>
    </div>

    <div class="row">
      <div>
        <label>Kickoff date (venue)</label>
        <input id="kickDate" type="date" />
      </div>
      <div>
        <label>Kickoff time (venue)</label>
        <input id="kickTime" type="time" />
      </div>
      <div>
        <label>Venue timezone (from API)</label>
        <input id="venueTz" placeholder="Ex: Europe/London" />
      </div>
    </div>

    <div class="row">
      <div>
        <label>League / competition</label>
        <input id="league" placeholder="Ex: Premier League" />
      </div>
      <div>
        <label>City / country</label>
        <input id="city" placeholder="Ex: Liverpool, England" />
      </div>
    </div>

    <div class="row">
      <div>
        <label>Paksha (auto from date)</label>
        <select id="paksha">
          <option value="shukla">Shukla</option>
          <option value="krishna">Krishna</option>
        </select>
      </div>
      <div>
        <label>&nbsp;</label>
        <button class="btn-secondary" id="btnAutoFromName">
          Auto team birds from name (lock)
        </button>
      </div>
    </div>

    <div class="tiny" id="dayInfo"></div>
    <div class="tiny" id="teamBirdInfo"></div>
  </div>

  <!-- STEP 3 -->
  <div class="card">
    <div class="title-sm">Step 3 ¬∑ Pure Panchapakshi Prediction (Auto Lock)</div>
    <button class="btn-primary" id="btnPredict">Run Panchapakshi Prediction</button>
    <div class="tiny" id="waitInfo">Waiting for match input‚Ä¶</div>

    <div id="resultBlock" style="display:none;margin-top:8px;">
      <div id="winnerLine" class="tiny"></div>
      <div id="percentBar"></div>
      <div id="drawLine" class="tiny"></div>
      <div id="scoreLine" class="tiny"></div>
      <div id="detailLine" class="tiny"></div>
    </div>
  </div>
</div>

<script>
/* ---------- BASIC DATA ---------- */
const BIRDS = ['Vulture','Owl','Crow','Cock','Peacock'];

const PLAYER_NAK_BIRDS = [
  'Peacock','Peacock','Peacock','Peacock','Peacock',
  'Cock','Cock','Cock','Cock','Cock','Cock',
  'Crow','Crow','Crow','Crow','Crow',
  'Owl','Owl','Owl','Owl','Owl',
  'Vulture','Vulture','Vulture','Vulture','Vulture','Vulture'
];

const DAY_PLANETS = ['Sun','Moon','Mars','Mercury','Jupiter','Venus','Saturn'];

const BIRD_PLANETS = {
  shukla: {
    Vulture: ['Jupiter','Saturn'],
    Owl:     ['Sun','Venus'],
    Crow:    ['Moon'],
    Cock:    ['Mars'],
    Peacock: ['Mercury']
  },
  krishna: {
    Vulture: ['Mars'],
    Owl:     ['Moon'],
    Crow:    ['Sun'],
    Cock:    ['Jupiter','Saturn'],
    Peacock: ['Mercury','Venus']
  }
};

const FRIENDLY_BIRDS = {
  Vulture: ['Owl','Cock'],
  Owl:     ['Vulture','Peacock'],
  Crow:    ['Peacock','Cock'],
  Cock:    ['Vulture','Crow'],
  Peacock: ['Owl','Crow']
};
const UNFRIENDLY_BIRDS = {
  Vulture: ['Peacock','Crow'],
  Owl:     ['Crow','Cock'],
  Crow:    ['Vulture','Owl'],
  Cock:    ['Peacock','Owl'],
  Peacock: ['Vulture','Cock']
};

/* activity scores lock */
const ACTIVITY_SCORES = {
  Rule:100,
  Eat:80,
  Walk:50,
  Sleep:30,
  Die:0
};
const ACTIVITIES = ['Rule','Eat','Walk','Sleep','Die'];

/* numerology: simple Chaldean style */
const NUM_MAP = {
  1:'aiyjqsAIYJQS',
  2:'bkrBKR',
  3:'cglCGL',
  4:'dmtDMT',
  5:'ehnxEHNX',
  6:'uvUWV',
  7:'ozOZ',
  8:'fpFP'
};
function nameToNumber(name){
  if(!name) return 0;
  let sum=0;
  for(const ch of name){
    for(const [num,letters] of Object.entries(NUM_MAP)){
      if(letters.includes(ch)){ sum += Number(num); break; }
    }
  }
  while(sum>9) sum = String(sum).split('').reduce((a,b)=>a+Number(b),0);
  return sum;
}

/* derive day ruling bird array from planet table */
function deriveRulingBirds(paksha){
  const map=BIRD_PLANETS[paksha];
  const arr=[];
  for(let d=0;d<7;d++){
    const planet=DAY_PLANETS[d];
    let chosen='Vulture';
    for(const bird of BIRDS){
      const list=map[bird]||[];
      if(list.includes(planet)){ chosen=bird;break;}
    }
    arr.push(chosen);
  }
  return arr;
}
const RULING_BIRDS = {
  shukla:deriveRulingBirds('shukla'),
  krishna:deriveRulingBirds('krishna')
};

/* moon age ‚Üí paksha */
function computeMoonAge(date){
  const year=date.getUTCFullYear();
  const month=date.getUTCMonth()+1;
  const day=date.getUTCDate();
  let yy = year - Math.floor((12 - month)/10);
  let mm = month + 9;
  if(mm>=12) mm -= 12;
  const k1 = Math.floor(365.25*(yy+4712));
  const k2 = Math.floor(30.6*mm+0.5);
  const k3 = Math.floor(Math.floor((yy/100)+49)*0.75) - 38;
  const jd = k1 + k2 + day + 59 - k3;
  const ip = (jd - 2451550.1)/29.530588853;
  const frac = ip - Math.floor(ip);
  return frac*29.530588853;
}
function autoPakshaFromDateStr(dateStr){
  if(!dateStr) return 'shukla';
  const d=new Date(dateStr+'T12:00:00Z');
  const age=computeMoonAge(d);
  return age<14.765?'shukla':'krishna';
}

/* helpers */
function timeToMins(t){
  if(!t) return 0;
  const [h,m]=t.split(':').map(Number);
  return h*60+m;
}
function minsToHHMM(m){
  let x=m%1440;
  if(x<0)x+=1440;
  const h=Math.floor(x/60);
  const mi=x%60;
  return String(h).padStart(2,'0')+':'+String(mi).padStart(2,'0');
}

/* simple activity from time (no paksha change, lock rule table) */
function getActivityForTime(mins){
  const slot = Math.floor(((mins%1440)+1440)%1440 / (1440/5)); // 0..4
  return ACTIVITIES[slot];
}

/* team bird from name numerology ‚Üí nakshatra ‚Üí bird */
function teamNameToBird(name){
  const num = nameToNumber(name.toUpperCase());
  if(!num) return null;
  const nakIndex = ((num-1)*3) % 27; // spreads a bit
  return PLAYER_NAK_BIRDS[nakIndex] || null;
}

/* global state */
let lastHomeBird=null;
let lastAwayBird=null;
let lastDayBird=null;

/* ---------- UI DOM ---------- */
const apiKeyInput   = document.getElementById('apiKey');
const btnLoad       = document.getElementById('btnLoad');
const matchesWrap   = document.getElementById('matchesWrap');
const matchesTable  = document.getElementById('matchesTable').querySelector('tbody');
const apiErrorDiv   = document.getElementById('apiError');

const homeTeamInput = document.getElementById('homeTeam');
const awayTeamInput = document.getElementById('awayTeam');
const kickDateInput = document.getElementById('kickDate');
const kickTimeInput = document.getElementById('kickTime');
const venueTzInput  = document.getElementById('venueTz');
const leagueInput   = document.getElementById('league');
const cityInput     = document.getElementById('city');
const pakshaSelect  = document.getElementById('paksha');

const dayInfoDiv    = document.getElementById('dayInfo');
const teamBirdInfoDiv = document.getElementById('teamBirdInfo');

const btnAutoFromName = document.getElementById('btnAutoFromName');
const btnPredict    = document.getElementById('btnPredict');
const waitInfo      = document.getElementById('waitInfo');
const resultBlock   = document.getElementById('resultBlock');
const winnerLine    = document.getElementById('winnerLine');
const percentBarDiv = document.getElementById('percentBar');
const drawLine      = document.getElementById('drawLine');
const scoreLine     = document.getElementById('scoreLine');
const detailLine    = document.getElementById('detailLine');

/* ---------- STEP 1: LOAD MATCHES ---------- */
btnLoad.addEventListener('click', async () => {
  const key = apiKeyInput.value.trim();
  apiErrorDiv.style.display='none';
  apiErrorDiv.textContent='';
  matchesWrap.style.display='none';
  matchesTable.innerHTML='';

  if(!key){
    apiErrorDiv.textContent='Please paste your API key.';
    apiErrorDiv.style.display='block';
    return;
  }

  const today = new Date();
  const yyyy = today.getFullYear();
  const mm = String(today.getMonth()+1).padStart(2,'0');
  const dd = String(today.getDate()).padStart(2,'0');
  const dateStr = `${yyyy}-${mm}-${dd}`;

  const url = `https://v3.football.api-sports.io/fixtures?date=${dateStr}&timezone=UTC&live=all`;

  try{
    const res = await fetch(url,{
      headers:{
        'x-apisports-key':key
      }
    });
    if(!res.ok){
      throw new Error('HTTP '+res.status);
    }
    const data = await res.json();

    if(data.errors && Object.keys(data.errors).length){
      throw new Error('API error / quota');
    }

    let fixtures = data.response || [];

    // filter: keep only not-finished
    const finishedCodes = ['FT','AET','PEN','CANC','ABD','AWD','WO','PST'];
    fixtures = fixtures.filter(f => !finishedCodes.includes(f.fixture.status.short));

    if(!fixtures.length){
      apiErrorDiv.textContent='No LIVE / upcoming matches found for today.';
      apiErrorDiv.style.display='block';
      return;
    }

    fixtures.sort((a,b)=> new Date(a.fixture.date) - new Date(b.fixture.date));

    matchesTable.innerHTML='';
    fixtures.forEach(fix=>{
      const tr=document.createElement('tr');
      tr.className='clickable';

      const utcDate = new Date(fix.fixture.date); // already UTC
      const koDate = utcDate.toISOString().slice(0,10);
      const koTime = utcDate.toISOString().slice(11,16);

      const isLive = ['1H','2H','ET','P','BT','HT'].includes(fix.fixture.status.short);
      const cityCountry = (fix.fixture.venue.city||'') +
        (fix.fixture.venue.city && fix.teams.home.country ? ', ':'') +
        (fix.teams.home.country||'');

      tr.innerHTML = `
        <td>${koDate} ${koTime}</td>
        <td>${fix.teams.home.name}</td>
        <td>${fix.teams.away.name}</td>
        <td>${fix.league.name}</td>
        <td>${cityCountry || '-'}</td>
        <td>${isLive?'<span class="live-dot">‚óè</span>LIVE':fix.fixture.status.short}</td>
      `;

      tr.addEventListener('click',()=>{
        homeTeamInput.value = fix.teams.home.name;
        awayTeamInput.value = fix.teams.away.name;
        kickDateInput.value = koDate;
        kickTimeInput.value = koTime;
        venueTzInput.value  = fix.fixture.timezone || 'UTC';
        leagueInput.value   = fix.league.name || '';
        cityInput.value     = cityCountry || '';

        const autoPak = autoPakshaFromDateStr(koDate);
        pakshaSelect.value = autoPak;

        updateDayInfo();
        autoTeamBirdsFromNames();
      });

      matchesTable.appendChild(tr);
    });

    matchesWrap.style.display='block';
  }catch(err){
    console.error(err);
    apiErrorDiv.textContent='Network / API error. Check internet + key + quota.';
    apiErrorDiv.style.display='block';
  }
});

/* ---------- DAY INFO ---------- */
function updateDayInfo(){
  const dateStr = kickDateInput.value;
  if(!dateStr){
    dayInfoDiv.textContent='Set kickoff date to see day ruling bird.';
    return;
  }
  const paksha = pakshaSelect.value;
  const d = new Date(dateStr+'T12:00:00Z');
  const dow = d.getUTCDay(); // 0=Sunday
  const dayBird = RULING_BIRDS[paksha][dow];
  lastDayBird = dayBird;

  const friendly = FRIENDLY_BIRDS[dayBird] || [];
  const enemy = UNFRIENDLY_BIRDS[dayBird] || [];

  dayInfoDiv.innerHTML =
    `<span class="tag tag-info">Day bird</span>`+
    `Ruling bird for match day: <span class="good-text">${dayBird}</span> `+
    `‚Ä¢ Friendly: <span class="home-text">${friendly.join(', ')||'-'}</span> `+
    `‚Ä¢ Enemy: <span class="bad-text">${enemy.join(', ')||'-'}</span>`;
}

/* ---------- AUTO TEAM BIRDS (LOCK) ---------- */
function autoTeamBirdsFromNames(){
  const homeName = homeTeamInput.value.trim();
  const awayName = awayTeamInput.value.trim();
  if(!homeName || !awayName){
    teamBirdInfoDiv.textContent='Enter both team names first.';
    return;
  }
  const homeBird = teamNameToBird(homeName) || 'Crow';
  const awayBird = teamNameToBird(awayName) || 'Crow';
  lastHomeBird = homeBird;
  lastAwayBird = awayBird;

  document.documentElement.style.setProperty('--home-main','#0ea5e9');
  document.documentElement.style.setProperty('--away-main','#22c55e');

  teamBirdInfoDiv.innerHTML =
    `<span class="tag tag-info">Team birds (locked)</span>`+
    `Home: <span class="home-text">${homeName}</span> ‚Üí <span class="good-text">${homeBird}</span> `+
    `‚Ä¢ Away: <span class="away-text">${awayName}</span> ‚Üí <span class="good-text">${awayBird}</span> `+
    `<br>Birds are auto-selected from team name numerology ‚Üí 27 nakshatra ‚Üí bird. Manual edit is locked üîí`;
}

btnAutoFromName.addEventListener('click', (e)=>{
  e.preventDefault();
  autoTeamBirdsFromNames();
  updateDayInfo();
});

kickDateInput.addEventListener('change',()=>{
  const autoPak = autoPakshaFromDateStr(kickDateInput.value);
  pakshaSelect.value = autoPak;
  updateDayInfo();
});
pakshaSelect.addEventListener('change', updateDayInfo);

/* ---------- STEP 3: PREDICTION ---------- */
btnPredict.addEventListener('click', (e)=>{
  e.preventDefault();
  runPrediction();
});

function runPrediction(){
  const homeName = homeTeamInput.value.trim();
  const awayName = awayTeamInput.value.trim();
  const dateStr  = kickDateInput.value;
  const timeStr  = kickTimeInput.value;

  if(!homeName || !awayName || !dateStr || !timeStr){
    alert('Please set team names + kickoff date + time (Step 2).');
    return;
  }

  if(!lastHomeBird || !lastAwayBird){
    autoTeamBirdsFromNames();
  }
  updateDayInfo();
  const dayBird = lastDayBird || 'Vulture';

  const kickoffMins = timeToMins(timeStr);
  const homeActivity = getActivityForTime(kickoffMins);
  const awayActivity = getActivityForTime((kickoffMins+20)); // small phase shift

  const homeActScore = ACTIVITY_SCORES[homeActivity];
  const awayActScore = ACTIVITY_SCORES[awayActivity];

  const friendlyHome = FRIENDLY_BIRDS[dayBird] || [];
  const enemyHome = UNFRIENDLY_BIRDS[dayBird] || [];

  function synergy(bird){
    if(bird===dayBird) return 30;
    if(friendlyHome.includes(bird)) return 15;
    if(enemyHome.includes(bird)) return -15;
    return 0;
  }

  const homeSyn = synergy(lastHomeBird);
  const awaySyn = synergy(lastAwayBird);

  let homeScore = homeActScore + homeSyn;
  let awayScore = awayActScore + awaySyn;

  if(homeScore<0) homeScore=0;
  if(awayScore<0) awayScore=0;

  let total = homeScore + awayScore;
  if(total===0){ homeScore=awayScore=1; total=2; }

  let homePct = (homeScore/total)*100;
  let awayPct = 100-homePct;

  // clamp to 30‚Äì70 band (rule lock)
  const clamp = p => p>70?70:p<30?30:p;
  homePct = clamp(homePct);
  awayPct = 100-homePct;

  let winner='Balanced / 50-50';
  if(homePct>awayPct+1) winner=homeName;
  else if(awayPct>homePct+1) winner=awayName;

  const diff = Math.abs(homePct-awayPct);
  const drawYes = diff<=6 ? 'YES (very close birds)' :
                  diff<=10? 'MAYBE (tight match)' :
                            'NO (one bird stronger)';

  let predictedScore='';
  let winnerActivity = null;
  if(winner===homeName){
    winnerActivity = homeActivity;
  }else if(winner===awayName){
    winnerActivity = awayActivity;
  }

  if(drawYes.startsWith('YES')){
    predictedScore = '1‚Äì1 or 2‚Äì2';
  }else if(!winnerActivity){
    predictedScore = '1‚Äì1 or 2‚Äì1 either side';
  }else{
    if(winnerActivity==='Rule'){
      predictedScore = '3‚Äì1 or 2‚Äì0 to winner';
    }else if(winnerActivity==='Eat'){
      predictedScore = '2‚Äì1 or 2‚Äì0 to winner';
    }else if(winnerActivity==='Walk'){
      predictedScore = '1‚Äì0 or 2‚Äì1 to winner';
    }else{
      predictedScore = '1‚Äì0 or 0‚Äì0 (low scoring)';
    }
  }

  // render
  waitInfo.style.display='none';
  resultBlock.style.display='block';

  winnerLine.innerHTML =
    `<span class="tag tag-win">Overall winner</span>`+
    `Prediction: <span class="${winner===homeName?'home-text':winner===awayName?'away-text':'mid-text'}">${winner}</span>`;

  percentBarDiv.innerHTML = makeBar(homeName,awayName,homePct,awayPct);

  drawLine.innerHTML =
    `<span class="tag tag-draw">Draw?</span>`+
    `<b>${drawYes}</b>`;

  scoreLine.innerHTML =
    `<span class="tag tag-score">Score hint</span>`+
    `<b>${predictedScore}</b>`;

  detailLine.innerHTML =
    `Home bird: <span class="home-text">${lastHomeBird}</span> `+
    `(activity at KO: <span class="mid-text">${homeActivity}</span>, score ${homeActScore}) ‚Ä¢ `+
    `Away bird: <span class="away-text">${lastAwayBird}</span> `+
    `(activity at KO: <span class="mid-text">${awayActivity}</span>, score ${awayActScore})<br>`+
    `Day bird: <span class="good-text">${dayBird}</span> ‚Ä¢ `+
    `Final strength ‚Üí Home ${homePct.toFixed(1)}% vs Away ${awayPct.toFixed(1)}%`;
}

function makeBar(homeName,awayName,homePct,awayPct){
  return `
    <div class="bar-wrap">
      <div class="bar-home" style="width:${homePct}%;"></div>
      <div class="bar-away" style="width:${awayPct}%;"></div>
      <div class="bar-label">
        <span class="home-text">${homeName} ${homePct.toFixed(1)}%</span>
        &nbsp;‚Ä¢&nbsp;
        <span class="away-text">${awayName} ${awayPct.toFixed(1)}%</span>
      </div>
    </div>
  `;
}

/* ---------- INIT ---------- */
(function init(){
  const today = new Date();
  const yyyy = today.getFullYear();
  const mm = String(today.getMonth()+1).padStart(2,'0');
  const dd = String(today.getDate()).padStart(2,'0');
  kickDateInput.value = `${yyyy}-${mm}-${dd}`;
  kickTimeInput.value = '12:00';

  const paksha = autoPakshaFromDateStr(kickDateInput.value);
  pakshaSelect.value = paksha;
  updateDayInfo();
})();
</script>
</body>
</html>
